[[extend 'auth_layout.html']]

<style>
[v-cloak] {
     display: none;
}
</style>


<div class="section" id="vue-target" v-cloak>

  <div class="container block">
    <h1 class="title has-text-weight-bold">Your Feedback Is Important to Us</h1>
  </div>

  <!-- Displays text box if in add post mode -->
  <div v-if="add_mode" class="container block">
    <div class="control container block">
      <textarea class="textarea" placeholder="Enter new post here" v-model="new_post">
      </textarea>
    </div>
    <div class="field">
      <div class="control">
        <input type="submit" @click="add_post" value="Post" class="button is-primary">
        <input type="submit" @click="set_add_status(false)" value="Cancel" class="button is-warning">
      </div>
    </div>
  </div>
  <div v-else class="container block">
    <button @click="set_add_status(true)" class="button is-primary">
      <i class="fa fa-plus fa-fw"></i>
      <span>Add Your Feedback</span>
    </button>
  </div>

  <!-- Displays all posts -->
  <div class="container block">
    <div v-for="post in rows.slice()" class="box has-background-light is-shadowless" >
      <div>{{post.post}}</div>
      <div class="has-text-grey-light">{{post.first_name}} {{post.last_name}}</div>
      <div class="columns block mt-0">
        <div class="column has-text-left">
          <nav class="level">
            <div class="level-left">
              <span @mouseenter="show_likes(post._idx)" class="level-item">
                <span @click="set_like(post._idx)" @mouseleave="hide_likes(post._idx)">
                  <div class="icon has-text-info">
                    <i v-if="post.like" class="fa fa-thumbs-up fas fa-lg fa-flip-horizontal"></i>
                    <i v-else class="fa fa-thumbs-o-up fas fa-lg fa-flip-horizontal"></i>
                  </div>
                </span>
              </span>
    
              <span @mouseenter="show_likes(post._idx)" class="level-item">
                <span @click="set_dislike(post._idx)" @mouseleave="hide_likes(post._idx)">
                  <div class="icon has-text-info">
                    <i v-if="post.dislike" class="fa fa-thumbs-down fas fa-lg fa-flip-horizontal"></i>
                    <i v-else class="fa fa-thumbs-o-down fas fa-lg fa-flip-horizontal"></i>
                  </div>
                </span>
              </span>
              <span v-if="post.show_likers" class="is-size-7 has-text-info level-item">
                {{like_sentence}}
              </span>
            </div>
          
          </nav>

        </div>
        <div v-if="'[[=user_email]]' === post.user_email" class="column has-text-right">
          <span class="icon has-text-danger">
            <i @click="delete_post(post._idx)" class="fa fa-trash fas fa-lg"></i>
          </span>
        </div>
      </div>
    </div>
  </div>

</div>


[[block page_scripts]]
<!-- Loads the index-specific js for Vue -->
<script>
  let load_posts_url = "[[=XML(load_posts_url)]]";
  let add_post_url = "[[=XML(add_post_url)]]";
  let delete_post_url = "[[=XML(delete_post_url)]]";
  let get_likes_url = "[[=XML(get_likes_url)]]";
  let set_like_url = "[[=XML(set_like_url)]]";
  let get_likers_url = "[[=XML(get_likers_url)]]";
</script>

<script src="js/"></script>
[[end]]
