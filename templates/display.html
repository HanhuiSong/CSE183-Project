[[extend 'auth_layout.html']]
<div class="section" >
  
  <!-- <a class="button is-success" href="[[=URL('add')]]">
    <span class="icon"><i class="fa fa-plus"></i></span>
    <span>Add</span>
  </a> -->

  <div class="container" id="vue-target-cars">
    <div v-if="display > 1">
      <table class="table is-striped is-fullwidth">
        <tr>
          <th>Id</th>
          <th>Brand</th>
          <th>Model</th>
          <th>Year</th>
          <th>Price</th>
          <th>Mileage</th>
          <th>Description</th>
          <th>Picture</th>
          <th>Zip Code</th>
          <th></th>
          <th></th>
        </tr> 
        <tr v-for="c in cars" :key="c.id">
          <template v-if="c.id === [[=cars_id]]">
          <td>{{c.id}}</td>
          <td>{{c.car_brand}}</td>
          <td>{{c.car_model}}</td>
          <td>{{c.car_year}}</td>
          <td>{{c.car_price}}</td>
          <td>{{c.car_mileage}}</td>
          <td>{{c.car_description}}</td>
          <td>
            <div class="field has-addons">
              <p class="control">
                <!-- <label class="label">Picture: </label> -->
                  <div class="control">
                  <div class="file is-info">
                    <label class="file-label">
                      <input class="file-input" type="file" @change="upload_file($event, c._idx)">
                      <span class="file-cta">
                        <span class="file-icon">
                          <i v-if="uploading" class="fa fa-spinner fa-pulse fa-fw"></i>
                          <i v-else class="fa fa-upload fa-fw"></i>
                        </span>
                        <span class="file-label">
                          <span v-if="!uploading">Upload new file</span>
                        </span>
                      </span> 
                    </label>
                  </div>
                </div>
              </p>
            </div> 
          </td>
          <td>{{c.car_city}}</td>
          <td>{{c.car_zip}}</td>
          </template>
        </tr>
      </table>
      <article class="message is-warning">
        <div class="message-header">
            <p>Note</p>
        </div>
        <div class="message-body">
            Please upload a picture no larger than <strong>5 MB</strong>. Thank you!
        </div>
    </article>
  </div>
    <div class="section" v-else-if="display > 0">
      <article class="message is-warning">
        <div class="message-header">
            <p>Notification</p>
        </div>
        <div class="message-body">
            You have successfully added your vehicles! : )
        </div>
    </article>
    <a class="button is-success" href="[[=URL('second_page')]]">
        <span class="icon"><i class="fa fa-backward"></i></span>
        <span>Back</span>
    </a>
    </div>
  </div>

  [[block page_scripts]]
  <!-- Loads the index-specific js for Vue -->
  <script>
    let upload_pic_url = "[[=XML(upload_pic_url)]]";
    let load_cars_info = "[[=XML(load_cars_info)]]";
   
    let obtain_gcs_url = "[[=XML(obtain_gcs_url)]]";
    let notify_url = "[[=XML(notify_url)]]";
    let delete_url = "[[=XML(delete_url)]]";
  </script>
  <script src="js/cars.js"></script>
  [[end]]
  
</div> 